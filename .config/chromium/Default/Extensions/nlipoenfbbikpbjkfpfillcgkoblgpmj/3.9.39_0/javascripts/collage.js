var borderWidth=10,defaultWidth=600,defaultHeight=600;function initBoard(){$("#board").css({padding:borderWidth+"px"}),$("#save").on("click",function(){chrome.cookies.get({url:"https://www.awesomescreenshot.com",name:"screenshot_personal_type"},function(e){e?"1"==e.value?html2canvas($("#board")[0],{allowTaint:!0,onrendered:function(e){var t=e.toDataURL(),a=t.split(",")[1],n=t.split(",")[0].split(":")[1].split(";")[0];var i=function(e,t,a){function n(e){return e.charCodeAt(0)}t=t||"",a=a||1024;for(var i=atob(e),o=[],r=0;r<i.length;r+=a){var d=i.slice(r,r+a),s=Array.prototype.map.call(d,n),l=new Uint8Array(s);o.push(l)}return new Blob(o,{type:t})}(a,n),o=(window.webkitURL||window.URL).createObjectURL(i),r=document.createElement("a"),d=document.createEvent("MouseEvents");d.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,0,null),r.setAttribute("href",o);var s="AS_collage_"+Date.now();r.setAttribute("download",s+"."+n.split("/")[1]),r.dispatchEvent(d)}}):showPremium("w-aws-advanced"):showPremium("w-aws-advanced-login")})}),$(".board-item").on("click",function(){var e=$(this).get(0).outerHTML;$("#board").empty().html(e).find(".board-part").append('<input type="file"/>').append('<div title="Remove image" class="board-item-remove">x</div>')}),$(".number-area").find("div").on("click",function(){$(this).siblings().removeClass("active"),$(this).addClass("active");var e=$(this).attr("data-tab");"0"==e?$(".board-item-container").show():($(".board-item-container").hide(),$(".board-item-container[data-index="+e+"]").show())}),$("#board").on("click",".board-item-remove",function(){$(this).parent().removeClass("added").find("img").remove(),$(this).parent().find("input").val("")}),$("#board").on("change","input",function(){var e=this.files[0];if(e){var t=URL.createObjectURL(e),a=document.createElement("img");a.onload=function(){},a.src=t;var n=$(this).parent();n.off("mousewheel").on("mousewheel",function(e){e.preventDefault();var t=e.originalEvent.wheelDelta/100,a=Math.exp(.1*t),n=$(this).find("img");n.css({width:n.width()*a,height:n.height()*a})}),$(a).appendTo(n).draggable(),n.addClass("added")}}),$("#board").on("dragover",".board-part",function(e){e.preventDefault(),e.stopPropagation()}),$("#board").on("dragenter",".board-part",function(e){console.log("dragenter"),$(this).addClass("dragover")}),$("#board").on("dragleave",".board-part",function(e){console.log("dragleave"),$(this).removeClass("dragover")}),$("#text-image").on("dragstart",function(e){e.originalEvent.dataTransfer.setData("imageUrl",this.src)}),$("#board").on("drop",".board-part",function(e){console.log("drop");var n=$(this);e.stopPropagation(),e.preventDefault(),console.log(e.originalEvent);var t=e.originalEvent,a=t.dataTransfer.files[0];if(a){var i=new FileReader;i.onload=function(e){var t=e.target.result,a=document.createElement("img");a.onload=function(){},a.src=t,$(a).appendTo(n).on("mousewheel",function(e){e.preventDefault();var t=e.originalEvent.wheelDelta/100,a=Math.exp(.2*t),n=$(this).find("img");n.css({width:n.width()*a,height:n.height()*a})}).draggable(),n.addClass("added")},i.readAsDataURL(a)}else if(t.dataTransfer.getData("imageUrl")){var o=document.createElement("img");o.onload=function(){},o.src=t.dataTransfer.getData("imageUrl"),$(o).appendTo(n).draggable(),n.addClass("added")}$(this).removeClass("dragover")}),$(".w-info").find(".w-close-btn").on("click",function(){1==$(".w-info").filter(function(){return $(this).is(":visible")}).length&&$("#w-wrapper").css({visibility:"hidden",opacity:0}),$(this).parent().hide(),"w-aws-create"==$(this).parent().attr("id")&&$("#c-p-input").val("")}),$(".w-info").find(".primary-btn").on("click",function(){$(".w-info").find(".w-close-btn").trigger("click")})}function showPremium(e){$("#w-wrapper").css({visibility:"visible",opacity:1}),$("#"+e).show()}function bindEvent(n){n.find("input").on("change",function(){var e=this.files[0];if(e){var t=URL.createObjectURL(e),a=document.createElement("img");a.onload=function(){},a.src=t,$(a).appendTo(n).draggable()}})}initBoard(),$(".board-item-21").trigger("click");