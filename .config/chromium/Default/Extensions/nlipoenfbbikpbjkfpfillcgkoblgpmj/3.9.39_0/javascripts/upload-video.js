var uploadVideo={YOUTUBE_BASE_URL:"https://www.googleapis.com/upload/youtube/v3/videos",INFO_URL:"https://preview.diigo.com/api/v3/awe/upload/?user_id=luokebi",getGoogleOauthToken:function(){return new Promise(function(o,t){chrome.identity.getAuthToken({interactive:!0},function(e){e?o(e):t()})})},uploadToYoutube:function(e,o){return this._upload(e,this.YOUTUBE_BASE_URL,o)},uploadToGoogleDrive:function(e,o){return this._upload(e,null,o)},_upload:function(i,a,r){return this.getGoogleOauthToken().then(function(n){return new Promise(function(t,o){if(a)var e={snippet:{title:i.name.replace(/\.webm$/,""),description:"Test"},status:{privacyStatus:"Unlisted"}};else e={title:i.name.replace(/\.webm$/,""),shareable:!0,shared:!0};new MediaUploader({baseUrl:a,file:i,token:n,metadata:e,params:{part:Object.keys(e).join(",")},onError:function(e){console.log(e),o(e)},onProgress:function(e){var o=Date.now(),t=e.loaded,n=e.total;this.uploadStartTime;r&&r(100*t/n)},onComplete:function(e){var o=JSON.parse(e);t(o)}}).upload()})})},uploadInfo:function(e){var n=this;return new Promise(function(o,t){$.ajax({type:"POST",url:n.INFO_URL,contentType:"application/json; charset=utf-8",data:JSON.stringify(e),success:function(e){console.log(e),o(e)},error:function(e,o){t(o)}})})}};